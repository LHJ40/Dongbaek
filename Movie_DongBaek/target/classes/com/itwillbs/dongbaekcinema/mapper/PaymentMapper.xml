<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.dongbaekcinema.mapper.PaymentMapper">
<!--   <cache-ref namespace=""/> -->

	<!-- 관리자페이지 - 결제내역에서 상세보기로 클릭했을때 id의 상세내역 -->
	<select id="selectPayment" resultType="com.itwillbs.dongbaekcinema.vo.PaymentVO">
		SELECT *
		FROM PAYMENTS p
		JOIN ORDERS o
		ON p.order_num = o.order_num
		where member_id = #{member_id}
	</select>
	
	<select id="selectPaymentList" resultType="com.itwillbs.dongbaekcinema.vo.PaymentVO">
		SELECT *
		FROM PAYMENTS p
		JOIN ORDERS o
		ON p.order_num = o.order_num
		
	</select>
	
	<!-- 마이페이지 - 회원의 나의 구매내역 조회(지영) -->
	<!--
	뷰 사용 : BUY_DETAIL 
		(결제번호, 결제이름, 결제 카드, 결제카드번호, 결제 금액, 결제상태,
		  영화이름, 티켓타입(일반/일반)
	리턴타입 : List<> -->
	<select id="selectMyPaymentList" resultType="com.itwillbs.dongbaekcinema.voNew.MyReservationDetailVO">
		SELECT *
			FROM BUY_DETAIL
			WHERE member_id = #{member_id}
			LIMIT #{pageNum} -- 후에 pageNum으로 조절
	</select>
	
	<!-- 페이징처리중 -->
	<select id="getPaymentList" resultType="com.itwillbs.dongbaekcinema.vo.PaymentVO">
		SELECT * 
			FROM PAYMENTS p
			JOIN ORDERS o
			ON p.order_num = o.order_num
			LIMIT #{start}, #{perPage}
	</select>
	
	<!-- 페이징처리중 -->
	<select id="getCount" resultType="int">
		SELECT COUNT(*)
			FROM PAYMENTS
	</select>
	
</mapper>
