<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.dongbaekcinema.mapper.PaymentMapper">
<!--   <cache-ref namespace=""/> -->

	<!-- 관리자페이지 - 결제내역에서 상세보기로 클릭했을때 id의 상세내역 -->
	<select id="selectPayment" resultType="com.itwillbs.dongbaekcinema.vo.PaymentVO">
		SELECT *
		FROM PAYMENTS p
		JOIN ORDERS o
		ON p.order_num = o.order_num
		where member_id = #{member_id}
	</select>
	
	<!-- 페이징처리로 없어도 됨 -->
<!-- 	<select id="selectPaymentList" resultType="com.itwillbs.dongbaekcinema.vo.PaymentVO"> -->
<!-- 		SELECT * -->
<!-- 		FROM PAYMENTS p -->
<!-- 		JOIN ORDERS o -->
<!-- 		ON p.order_num = o.order_num -->
		
<!-- 	</select> -->
	
	<!-- 마이페이지 - 회원의 나의 구매내역 조회 -->
	<select id="selectMyPaymentList" resultType="com.itwillbs.dongbaekcinema.vo.PaymentVO">
		SELECT *
			FROM PAYMENTS p
			JOIN ORDERS o
				ON p.order_num = o.order_num
			WHERE member_id = #{member_id}
			LIMIT 3 -- 후에 pageNum으로 조절
	</select>
	
	<!-- 페이징처리중 - 0615 정의효 -->
	<select id="getPaymentList" resultType="com.itwillbs.dongbaekcinema.vo.PaymentVO">
		SELECT * 
			FROM PAYMENTS p
			JOIN ORDERS o
			ON p.order_num = o.order_num
			ORDER BY o.order_num DESC
			LIMIT #{start}, #{perPage}
	</select>
	
	<!-- 페이징처리중 - 0615 정의효 -->
	<select id="getCount" resultType="int">
		SELECT COUNT(*)
			FROM PAYMENTS
	</select>
	
</mapper>
